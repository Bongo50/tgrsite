{% extends "tgrsite/main.html" %}

{% load messaging_tags %}
{% block title %}
Messages
{% endblock %}
{% block body %}
<h1>Messages</h1>
<ul>
	{% for thread in threads %}
	<li>
		<a href="{% url 'message_thread' thread.id %}">
		<strong>{% get_participants_excluding_self thread user %}
		({{thread.get_latest.timestamp}})</strong></a>

		{% include 'messaging/messages.html' with messages=thread.five %}
	</li>
	<br>
	{% empty %}
		You haven't received any messages yet.
	{% endfor %}
</ul>
{% endblock %}


{% block rightbar %}
<div class="panel panel-default">
	<div class="panel-heading">
		Quick DM
	</div>
	<div class="panel-body">
		<form method="POST" action="{% url 'message_dm' %}?next={{request.path}}" id="quickdm">
			{% csrf_token %}
			<div class="form-group">
				<input class="form-control" name="target" placeholder="to (comma separated for group)">
				<textarea class="form-control" placeholder="message" name="message" form="quickdm"></textarea>
				<input type="submit" class="form-control" value="Send">
			</div>
		</form>
	</div>
</div>
{% endblock %}
