{% extends "tgrsite/main.html" %}

{% load messaging_tags %}

{% block body %}
<h1>Messages</h1>
{% comment forms.py %}
I mean I _should_ do a proper Django Form but i cba
{% endcomment %}
Quick DM
<form method="POST" action="{% url 'message_dm' %}" id="quickdm">
	{% csrf_token %}
	<div class="form-group">
	<input class="form-control" name="target" placeholder="to (comma separated for group)">
	<textarea class="form-control" placeholder="message" name="message" form="quickdm"></textarea>
	<input type="submit" class="form-control" value="Send">
</form>
<ul>
	{% for thread in threads %}
	<li>
		<strong>{% get_participants_excluding_self thread user %}
		({{thread.get_latest.timestamp}})</strong>
		<ul>
		{% for message in thread.get_messages %}
			<li><a href="{% url 'user' message.sender.id %}">{{message.sender}}</a>: {{message.content}}</li>
		{% endfor %}
		</ul>
	</li>
	<br>
	{% endfor %}
</ul>
{% endblock %}
