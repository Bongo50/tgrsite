{% extends "tgrsite/main.html" %}
{% block title %}
    {{ current }}
{% endblock %}

{% block pagetitle %}{{ current }}{% endblock %}

{% block breadcrumbs_parents %}
    <li class="breadcrumb-item"><a href="{% url "forum:forum" %}">Forum</a></li>
    {% for parent in current.get_parents %}
        <li class="breadcrumb-item"><a href="{% url "forum:subforum" parent.pk %}">{{ parent.title }}</a></li>
    {% endfor %}
{% endblock %}
{% block breadcrumbs_child %}{{ current }}{% endblock %}
{% block body %}

    {% if forums %}
        {# Forum List #}
        <div class="mb-2">
            <h3>Subforums</h3>
            {% include "forum/widgets/subforum_list.html" with forums=forums %}
        </div>
    {% endif %}


    {% if threads %}
        <div class="mb-2">
            <h3>Threads</h3>
            {% include "forum/widgets/thread_list.html" with threads=threads %}
        </div>
        {# Thread list #}
        THREADS: {{ current.get_threads_count }}
        <div class="list-group">
            {% for thread in threads %}
                <a href="{% url 'forum:viewthread' thread.id %}" class="list-group-item">

                    {% if thread.is_pinned %}
                        <i class="far fa-sticky-note"></i>
                    {% endif %}
                    {{ thread.title }}

                    <span class="pull-right">
			{{ thread.pub_date|timesince }} ago
			</span>
                    <br>
                    <small>{{ thread.author|truncatechars:32 }}</small>
                    <span class="pull-right">
				{{ thread.get_response_count }} response{{ thread.get_response_count|pluralize }}
			</span>

                </a>
            {% endfor %}
        </div>
    {% endif %}

    {# New Thread #}
    {% if request.user.is_authenticated and current != 'Forum' %}
        <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#createThreadCollapse"
                aria-expanded="false" aria-controls="createThreadCollapse">Create Thread
        </button>
        <div class="collapse" id="createThreadCollapse">
            <div class="panel panel-default">
                <div class="panel-body">
                    <form action="{% url 'forum:createthread' %}" method="POST">
                        {% csrf_token %}
                        <div class="form-group">
                            {% include "widgets/render_form_content.html" with form=form %}
                            <input type="hidden" name="forum" value="{{ current.id }}">
                        </div>
                        <input type="submit" class="form-control btn-primary" value="Post">
                    </form>
                </div>
            </div>
        </div>

    {% endif %}
{% endblock %}
