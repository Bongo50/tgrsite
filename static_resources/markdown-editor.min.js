var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,d,b){a instanceof String&&(a=String(a));for(var e=a.length,f=0;f<e;f++){var l=a[f];if(d.call(b,l,f,a))return{i:f,v:l}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,d,b){a!=Array.prototype&&a!=Object.prototype&&(a[d]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,d,b,e){if(d){b=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var f=a[e];f in b||(b[f]={});b=b[f]}a=a[a.length-1];e=b[a];d=d(e);d!=e&&null!=d&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:d})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");$jscomp.polyfill("Object.is",function(a){return a?a:function(a,b){return a===b?0!==a||1/a===1/b:a!==a&&b!==b}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,b){var d=this;d instanceof String&&(d=String(d));var f=d.length;b=b||0;for(0>b&&(b=Math.max(b+f,0));b<f;b++){var l=d[b];if(l===a||Object.is(l,a))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,d,b){if(null==a)throw new TypeError("The 'this' value for String.prototype."+b+" must not be null or undefined");if(d instanceof RegExp)throw new TypeError("First argument to String.prototype."+b+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,b){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,b||0)}},"es6","es3");
function csrfSafeMethod(a){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(a)}$.ajaxSetup({beforeSend:function(a,d){csrfSafeMethod(d.type)||this.crossDomain||(d=getCookie("csrftoken"),a.setRequestHeader("X-CSRFToken",d))}});
(function(a,d,b,e){a.fn.MarkdownEditor=function(){var b=function(a,b){var c=a.value;a=b;-1<c.indexOf("\r\n")&&(b=c.replace(/\r\n/g,"\n").slice(0,b).match(/\n/g),a+=b?b.length:0);return a},d={bold:{start:"**",end:"**",placeholder:"Your bold text"},italic:{start:"*",end:"*",placeholder:"Your emphasized text"},link:{start:"[",end:"](N)",placeholder:"Add your link title"},head:{start:"#",end:"",placeholder:"Your header"},image:{start:"![",end:"](N)",placeholder:"Add image description"},pre:{start:"",
end:"",placeholder:"\n    Add your code block here\n"},code:{start:"`",end:"`",placeholder:"Add inline code here"},ul:{start:"* ",end:"",placeholder:"List Item"},ol:{start:"1. ",end:"",placeholder:"List Item"}};return this.each(function(){var c=this,e=!0,f=a('<div class="controls" id="'+c.id+'-controls" />');a(c).before(f.append('<div class="btn-toolbar" role="toolbar" aria-label="Markdown Toolbar"><div class="btn-group mr-2 mb-1" role="group" aria-label="Formatting"><button type="button" data-toggle="tooltip" data-placement="bottom" title="Bold" class="btn btn-light c-bold"><i class="fas fa-bold"></i></button><button type="button" data-toggle="tooltip" data-placement="bottom" title="Italic" class="btn btn-light c-italic"><i class="fas fa-italic"></i></button><button type="button" data-toggle="tooltip" data-placement="bottom" title="Heading" class="btn btn-light c-head"><i class="fas fa-heading"></i></button><button type="button" data-toggle="tooltip" data-placement="bottom" title="Code" class="btn btn-light c-code"><i class="fas fa-code"></i></button></div><div class="btn-group mr-2 mb-1" role="group" aria-label="Utilities"><button type="button" data-toggle="tooltip" data-placement="bottom" title="Link" class="btn btn-light c-link"><i class="fas fa-link"></i></button><button type="button" data-toggle="tooltip" data-placement="bottom" title="Image" class="btn btn-light c-image"><i class="fas fa-image"></i></button></div><div class="btn-group mr-2 mb-1" role="group" aria-label="Lists"><button type="button" data-toggle="tooltip" data-placement="bottom" title="Bullet List" class="btn btn-light c-ul"><i class="fas fa-list-ul"></i></button><button type="button" data-toggle="tooltip" data-placement="bottom" title="Ordered List" class="btn btn-light c-ol"><i class="fas fa-list-ol"></i></button></div><div class="btn-group mr-2 mb-1" role="group" aria-label="Preview"><button type="button" data-toggle="tooltip" data-placement="bottom" title="Preview" class="btn btn-light c-preview"><i class="fas fa-eye"></i></button></div></div><div class="preview"></div>'));
f.find(".preview").slideUp();a(c).on("keypress",function(a){f.find(".card").addClass("text-muted");f.find(".fa-eye-slash").removeClass("fa-eye-slash").addClass("fa-eye");e=!0;return MarkdownHelper(c,a)});a("button",f).on("click",function(g){g.preventDefault();c.focus();var k=this.className.substr(16),h=c.selectionStart;g=c.selectionEnd;if("preview"===k)return e?(e=!1,f.find(".fa-eye").removeClass("fa-eye").addClass("fa-eye-slash"),createPreview(c,f)):(f.find(".preview").slideUp(),f.find(".fa-eye-slash").removeClass("fa-eye-slash").addClass("fa-eye"),
e=!0),!0;if(["head","ul","ol"].includes(k)){h=c.value.lastIndexOf("\n",h)+1;var l=c.value.indexOf("\n",g)-1;g=-2===l?g:l}l=c.value.substring(h,g);var n=a.trim(c.value.charAt(h-1)+c.value.charAt(g));k="code"===k&&(-1!==l.indexOf("\n")||!n||1>c.value.length)?"pre":k;n=a.extend({},d[k]);var m=a.trim(n.placeholder),p=n.placeholder.indexOf(m);if(l===m)return!0;if(-1!==a.inArray(k,["link","image"])){var q=prompt("image"!==k?"Enter the URL":"Enter image URL","http://");if(q)n.end=n.end.replace("N",q);else return!0}h===
g?(c.value=c.value.substring(0,h)+n.start+n.placeholder+n.end+c.value.substring(g),k=h+n.start.length+p,g=g+n.start.length+p+m.length,c.focus(),c.setSelectionRange?c.setSelectionRange(b(c,k),b(c,g)):c.createTextRange&&(h=c.createTextRange(),h.collapse(!0),h.moveEnd("character",g),h.moveStart("character",k),h.select())):"pre"===k?(h=c.value.lastIndexOf("\n",c.selectionStart),k=c.selectionEnd,-1===h&&(h=0),"\n"===c.value.charAt(k-1)&&--k,k=c.value.indexOf("\n",k),-1===k&&(k=c.value.length),g="\n"+c.value.substring(h,
k)+"\n\n",h=c.value.substring(0,h),h+=g.replace(/^(?=.+)/mg,Array(5).join(" ")),h+=c.value.substring(k),c.value=h):c.value=c.value.substring(0,h)+n.start+l+n.end+c.value.substring(g);return!0})})}})(jQuery,window,document);function createPreview(a,d){$.post("/api/md_preview/",{md:a.value},function(a,e,f){d.find(".preview").html(a).slideDown()})}
function MarkdownHelper(a,d){if(13===d.keyCode){var b=!1;d=a.value.replace(/\r\n/g,"\n");if(a.selectionStart)var e=a.selectionStart;else a.focus(),e=document.selection.createRange(),e.moveStart("character",-d.length),e=e.text.replace(/\r\n/g,"\n").length;var f=d.split("\n");var l=d.substr(0,e).split("\n").length;var c=f[l-1].replace(/^\s+/,"");var p=c.substr(0,2);if(/^[0-9]+[.] (.*)$/.test(c)){var m=c.substr(0,c.indexOf(". "));var g=m+". ";m=parseInt(m,10)+1+". ";b=!0}c&&!b&&"    "===f[l-1].substr(0,
4)&&(g=m="    ",b=!0);0<=["* ","+ ","- "].indexOf(p)&&(g=m=p,b=!0);if(b)return b=f[l-1].indexOf(g),c.replace(/^\s+/,"")===g?(a.value=d.substr(0,e-1-b-m.length)+"\n\n"+d.substr(e,d.length),g=e+1-m.length-b):(a.value=d.substr(0,e)+"\n"+Array(b+1).join(" ")+m+d.substr(e,d.length),g=e+1+m.length+b),a.selectionStart?a.setSelectionRange(g,g):(e=a.createTextRange(),e.move("character",g),e.select()),!1}}
function getCookie(a){var d=null;if(document.cookie&&""!==document.cookie)for(var b=document.cookie.split(";"),e=0;e<b.length;e++){var f=b[e].trim();if(f.substring(0,a.length+1)===a+"="){d=decodeURIComponent(f.substring(a.length+1));break}}return d};
